<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"> 

<h:head>
    <meta charset="UTF-8" />
    <title>Relatórios de Alunos</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .form-grid { border-spacing: 10px; border-collapse: separate; }
        .data-table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        .data-table th, .data-table td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        .data-table .header { background-color: #f2f2f2; }
        .btn-group button { margin-right: 10px; }
        .nav-link { margin-bottom: 20px; display: inline-block; }
    </style>
</h:head>

<body> 
	<h:link outcome="index" value="&larr; Voltar para a Página Inicial" styleClass="nav-link"/>
	<h1>Relatórios de Alunos</h1>
	
	<h:form>
        <fieldset>
            <legend>Filtros de Pesquisa</legend>
            <h:panelGrid columns="2" styleClass="form-grid">

                <h:outputLabel value="Curso:" for="curso"/>
                <h:selectOneMenu id="curso" value="#{relatorioBean.cursoId}">
                    <f:selectItem itemLabel="Todos os Cursos" itemValue="0" />
                    <f:selectItems value="#{relatorioBean.cursos}" var="c" itemLabel="#{c.nome}" itemValue="#{c.id}"/>
                </h:selectOneMenu>
                
                <h:outputLabel value="Faixa de Idade (de):" for="idadeMin"/>
                <h:inputText id="idadeMin" value="#{relatorioBean.idadeMin}" />

                <h:outputLabel value="Faixa de Idade (até):" for="idadeMax"/>
                <h:inputText id="idadeMax" value="#{relatorioBean.idadeMax}" />

                <h:outputLabel value="Cidade (contém):" for="cidade"/>
                <h:inputText id="cidade" value="#{relatorioBean.cidade}" />

                <h:panelGroup styleClass="btn-group">
                    <h:commandButton value="Filtrar" action="#{relatorioBean.filtrar}" />
                    <h:commandButton value="Limpar" action="#{relatorioBean.limparFiltros}" />
                </h:panelGroup>

            </h:panelGrid>
        </fieldset>
</h:form>
        <hr style="margin-top: 30px;" />
<h:form>
        <h2>Resultados</h2>
        <h:dataTable value="#{relatorioBean.alunosFiltrados}" var="aluno" 
                     rendered="#{not empty relatorioBean.alunosFiltrados}"
                     styleClass="data-table" headerClass="header">
            
            <h:column><f:facet name="header">Nome</f:facet><h:outputText value="#{aluno.nome}" /></h:column>
            <h:column><f:facet name="header">Idade</f:facet><h:outputText value="#{aluno.idade}" /></h:column>
            <h:column><f:facet name="header">Curso</f:facet><h:outputText value="#{aluno.curso.nome}" /></h:column>
            <h:column><f:facet name="header">Cidade</f:facet><h:outputText value="#{aluno.endereco.cidade}" /></h:column>
            </h:dataTable>
        
        <h:outputText value="Nenhum aluno encontrado com os filtros aplicados." 
                      rendered="#{empty relatorioBean.alunosFiltrados and facesContext.postback}" />
        
    </h:form>
</body> 
</html>
